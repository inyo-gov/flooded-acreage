<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>flooded-acreage - Parameters</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">flooded-acreage</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Parameters</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Import necessary libraries authenticate using gcloud api enabled on gcloud project</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 import libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ee</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geemap</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> folium</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geemap.foliumap <span class="im">as</span> geemap</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timedelta</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Trigger authentication</p>
<div class="cell" data-execution_count="132">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># run this in terminal to authenticate with gcloud &gt;&gt; earthengine authenticate</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
</div>
<p>Initialize Earth Engine</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>ee.Initialize()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
</div>
<p>surface reflectance threshold start date the end date is currently start date + 15 days and the first clear scene, low cloud cover will be selected and the image date is used in the reporting and filenaming convention along with the SR threshold value.</p>
<p>Spring 2023</p>
<div class="cell" data-execution_count="134">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#---Mar 2023---730 ac***</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold = .15</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># start_date = '2023-02-15'</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#---Mar 2023---1604 ac</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold = .20</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># start_date = '2023-02-15'</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#---May 2023---300 ac</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold = .15</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># start_date = '2023-05-01'</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">#---May 2023---449 ac</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold = .20</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># start_date = '2023-05-01'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
</div>
<p>Fall 2023</p>
<div class="cell" data-execution_count="135">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#---Oct 2023---1175 ac</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold = .22</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># start_date = '2023-10-03'</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#---Nov 2023---618 ac</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold = .16</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># start_date = '2023-11-03'</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#---Nov 2023---760 ac</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold = .18</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># start_date = '2023-11-03'</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#---Nov 2023---987 ac</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold = .20</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># start_date = '2023-11-03'</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co">#---Nov 2023--- 1125 ac</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold = .21</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># start_date = '2023-11-03'</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co">#---Nov 2023---1325 ac***</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold = .22</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co"># start_date = '2023-11-03'</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
</div>
<p>Spring 2024</p>
<div class="cell" data-execution_count="136">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#---Mar 2024---1130 acres***</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold = .15</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># start_date = '2024-02-25'</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#---Mar 2024---1355 acres***</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold = .16</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># start_date = '2024-02-25'</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#---May 2024---</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># start_date = '2024-05-10'</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold = .22</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#---Jun 2024---92 ac</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co"># start_date = '2024-06-01'</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold = .15</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#---Jun 2024---109 ac</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co"># start_date = '2024-06-01'</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold = .16</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co">#---Jun 2024---109 ac</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co"># start_date = '2024-06-06'</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold = .16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
</div>
<p>Fall 2024</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>threshold <span class="op">=</span> <span class="fl">.21</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>start_date <span class="op">=</span> <span class="st">'2024-09-22'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
</div>
<p>Compute the end date by adding days to the start date</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>end_date <span class="op">=</span> (datetime.strptime(start_date, <span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st">'</span>) <span class="op">+</span> timedelta(days<span class="op">=</span><span class="dv">15</span>)).strftime(<span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
</div>
<p>Report Directory</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Define the bounding box coordinates and create a bounding box geometry</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the bounding box coordinates</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>bbox <span class="op">=</span> [[<span class="op">-</span><span class="fl">118.23240736400778</span>, <span class="fl">36.84651455123723</span>],</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>        [<span class="op">-</span><span class="fl">118.17232588207419</span>, <span class="fl">36.84651455123723</span>],</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        [<span class="op">-</span><span class="fl">118.17232588207419</span>, <span class="fl">36.924364295139625</span>],</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        [<span class="op">-</span><span class="fl">118.23240736400778</span>, <span class="fl">36.924364295139625</span>]]</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bounding box geometry</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>bounding_box_geometry <span class="op">=</span> ee.Geometry.Polygon(bbox)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
</div>
<p>Filter sentinel 2 surface reflectance imagery and extract dates, pixel size</p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># COPERNICUS/S2_SR_HARMONIZED, allows comparisons between dates compared to S2_SR</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>sentinel_collection <span class="op">=</span> ee.ImageCollection(<span class="st">'COPERNICUS/S2_SR_HARMONIZED'</span>) <span class="op">\</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    .filterBounds(bounding_box_geometry) <span class="op">\</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    .filterDate(start_date, end_date) <span class="op">\</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(ee.Filter.lt(<span class="st">'CLOUDY_PIXEL_PERCENTAGE'</span>, <span class="dv">30</span>)) <span class="op">\</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    .select([<span class="st">'B8'</span>, <span class="st">'SCL'</span>,<span class="st">'B3'</span>,<span class="st">'B4'</span>,<span class="st">'B11'</span>])  <span class="co"># Select NIR band (B8) and Scene Classification Layer (SCL) for masking clouds</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>size <span class="op">=</span> sentinel_collection.size().getInfo()</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number of images in collection: </span><span class="sc">{</span>size<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of images in collection: 1</code></pre>
</div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Select a single band before retrieving the projection information</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>pixel_size <span class="op">=</span> sentinel_collection.first().select(<span class="st">'B8'</span>).projection().nominalScale().getInfo()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the date information</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>image_info <span class="op">=</span> sentinel_collection.first().getInfo()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>image_date <span class="op">=</span> image_info[<span class="st">'properties'</span>][<span class="st">'system:time_start'</span>]</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>image_date_str <span class="op">=</span> pd.to_datetime(image_date, unit<span class="op">=</span><span class="st">'ms'</span>).strftime(<span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st">'</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
</div>
<p>report and map directories and file names</p>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># directory location for reports</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>html_subdirectory <span class="op">=</span> <span class="st">"flood_reports/html_reports_maps"</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>os.makedirs(html_subdirectory, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define filenames with unique names based on the image date</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>report_filename <span class="op">=</span> os.path.join(html_subdirectory, <span class="ss">f"bwma_flood_report_</span><span class="sc">{</span>image_date_str<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>threshold<span class="sc">}</span><span class="ss">.html"</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>map_filename <span class="op">=</span> os.path.join(html_subdirectory, <span class="ss">f"flooded_area_map_</span><span class="sc">{</span>image_date_str<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>threshold<span class="sc">}</span><span class="ss">.html"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
</div>
<p>Create a cloud-free composite by masking cloudy pixels</p>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mask_clouds(image):</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    cloud_prob <span class="op">=</span> image.select(<span class="st">'SCL'</span>)  <span class="co"># Scene Classification Layer (SCL)</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    is_cloud <span class="op">=</span> cloud_prob.eq(<span class="dv">9</span>)  <span class="co"># 9 represents clouds in the SCL</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> image.updateMask(is_cloud.Not())</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>cloud_free_composite <span class="op">=</span> sentinel_collection.<span class="bu">map</span>(mask_clouds).median()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
</div>
<p>Define binary image base on the threshold</p>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>binary_image <span class="op">=</span> cloud_free_composite.select(<span class="st">'B8'</span>).divide(<span class="dv">10000</span>).lt(threshold).selfMask()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
</div>
<p>Load units from geojson and convert to earth engine geometry</p>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>gdf <span class="op">=</span> gpd.read_file(<span class="st">"data/unitsBwma2800.geojson"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>units <span class="op">=</span> geemap.geopandas_to_ee(gdf)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>units <span class="op">=</span> units.filterBounds(bounding_box_geometry)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>units_clipped <span class="op">=</span> units.<span class="bu">map</span>(<span class="kw">lambda</span> feature: feature.intersection(bounding_box_geometry))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
</div>
<p>Compute the unit area and flooded area</p>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute area of each unit</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_area(feature):</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> feature.<span class="bu">set</span>({<span class="st">'unit_acres'</span>: feature.geometry().area().divide(<span class="fl">4046.86</span>)})</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>units_with_area <span class="op">=</span> units_clipped.<span class="bu">map</span>(compute_area)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the flooded area within each unit</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_refined_flood_area(feature):</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    geom <span class="op">=</span> feature.geometry()</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    total_pixels <span class="op">=</span> cloud_free_composite.select(<span class="st">'B8'</span>).reduceRegion(</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>        reducer<span class="op">=</span>ee.Reducer.count(), geometry<span class="op">=</span>geom, scale<span class="op">=</span><span class="dv">10</span>).get(<span class="st">'B8'</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    flooded_pixels <span class="op">=</span> binary_image.reduceRegion(</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>        reducer<span class="op">=</span>ee.Reducer.count(), geometry<span class="op">=</span>geom, scale<span class="op">=</span><span class="dv">10</span>).get(<span class="st">'B8'</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    pixel_area_m2 <span class="op">=</span> ee.Number(pixel_size).multiply(pixel_size)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    pixel_area_acres <span class="op">=</span> pixel_area_m2.multiply(<span class="fl">0.000247105</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    flooded_area_acres <span class="op">=</span> ee.Number(flooded_pixels).multiply(pixel_area_acres)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    flooded_percentage <span class="op">=</span> ee.Number(flooded_pixels).divide(total_pixels).multiply(<span class="dv">100</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    unit_name <span class="op">=</span> feature.get(<span class="st">'Flood_Unit'</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    label <span class="op">=</span> ee.String(unit_name).cat(<span class="st">': '</span>).cat(flooded_area_acres.<span class="bu">format</span>(<span class="st">'</span><span class="sc">%.2f</span><span class="st">'</span>)).cat(<span class="st">' Acres'</span>)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> feature.<span class="bu">set</span>({</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">'total_pixels'</span>: total_pixels,</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">'flooded_pixels'</span>: flooded_pixels,</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">'acres_flooded'</span>: flooded_area_acres,</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">'flooded_percentage'</span>: flooded_percentage,</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">'label'</span>: label</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>units_with_calculations <span class="op">=</span> units_with_area.<span class="bu">map</span>(compute_refined_flood_area)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
</div>
<p>Convert EE feature collection to Pandas DataFrame</p>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>units_df_properties_reduced <span class="op">=</span> pd.DataFrame(units_with_calculations.getInfo()[<span class="st">'features'</span>])</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>units_df_properties_reduced <span class="op">=</span> pd.json_normalize(units_df_properties_reduced[<span class="st">'properties'</span>])</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>units_df_properties_reduced <span class="op">=</span> units_df_properties_reduced[[<span class="st">'Flood_Unit'</span>, <span class="st">'total_pixels'</span>, <span class="st">'flooded_pixels'</span>, <span class="st">'unit_acres'</span>, <span class="st">'acres_flooded'</span>, <span class="st">'flooded_percentage'</span>]]</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Round numbers</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>units_df_properties_reduced <span class="op">=</span> units_df_properties_reduced.<span class="bu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
</div>
<p>Calculate Total Acreage and add total row</p>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate totals</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>total_acres <span class="op">=</span> units_df_properties_reduced[<span class="st">'unit_acres'</span>].<span class="bu">sum</span>()</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>total_flooded_acres <span class="op">=</span> units_df_properties_reduced[<span class="st">'acres_flooded'</span>].<span class="bu">sum</span>()</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>total_flooded_percentage <span class="op">=</span> (total_flooded_acres <span class="op">/</span> total_acres) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a row for totals</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>totals <span class="op">=</span> pd.DataFrame([{</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Flood_Unit'</span>: <span class="st">'Total'</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'total_pixels'</span>: units_df_properties_reduced[<span class="st">'total_pixels'</span>].<span class="bu">sum</span>(),</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'flooded_pixels'</span>: units_df_properties_reduced[<span class="st">'flooded_pixels'</span>].<span class="bu">sum</span>(),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'unit_acres'</span>: total_acres,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'acres_flooded'</span>: total_flooded_acres,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'flooded_percentage'</span>: total_flooded_percentage</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>}])</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate totals to the original dataframe</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>units_df_properties_reduced <span class="op">=</span> pd.concat([units_df_properties_reduced, totals], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Round the totals row</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>units_df_properties_reduced <span class="op">=</span> units_df_properties_reduced.<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted DataFrame</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(units_df_properties_reduced.to_string(index<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     Flood_Unit  total_pixels  flooded_pixels  unit_acres  acres_flooded  flooded_percentage
        Thibaut         99955            2592     1971.07          64.05                2.59
           Drew         25462             806      502.65          19.92                3.17
      Waggonner         63198            1214     1246.13          30.00                1.92
 West Winterton         40855            1633      805.68          40.35                4.00
 East Winterton         17010               9      335.14           0.22                0.05
South Winterton         26035              31      513.46           0.77                0.12
  Thibaut Ponds         26753             504      527.63          12.45                1.88
          Total        299268            6789     5901.76         167.76                2.84</code></pre>
</div>
</div>
<p>Create and Save HTML Map</p>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define visualization parameters for a better false-color composite</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>false_color_vis <span class="op">=</span> {</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'min'</span>: <span class="dv">0</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max'</span>: <span class="dv">3000</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'bands'</span>: [<span class="st">'B11'</span>, <span class="st">'B8'</span>, <span class="st">'B4'</span>],  <span class="co"># SWIR1 (B11), NIR (B8), Red (B4)</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'gamma'</span>: <span class="fl">1.4</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the Sentinel-2 image collection filtered by date, cloud cover, and bounds</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>sentinel_collection <span class="op">=</span> ee.ImageCollection(<span class="st">'COPERNICUS/S2_SR_HARMONIZED'</span>) <span class="op">\</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    .filterBounds(bounding_box_geometry) <span class="op">\</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    .filterDate(start_date, end_date) <span class="op">\</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(ee.Filter.lt(<span class="st">'CLOUDY_PIXEL_PERCENTAGE'</span>, <span class="dv">30</span>)) <span class="op">\</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    .select([<span class="st">'B8'</span>, <span class="st">'B11'</span>, <span class="st">'B4'</span>, <span class="st">'SCL'</span>])  <span class="co"># Select NIR (B8), SWIR1 (B11), Red (B4), and Scene Classification Layer (SCL)</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Clip the binary image to the unit boundaries</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>clipped_binary_image <span class="op">=</span> binary_image.clip(units)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a folium map</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>Map <span class="op">=</span> geemap.Map(center<span class="op">=</span>[<span class="fl">36.8795</span>, <span class="op">-</span><span class="fl">118.202</span>], zoom<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the false-color composite to the map</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>Map.addLayer(sentinel_collection.median(), false_color_vis, <span class="st">'False-Color Composite'</span>)</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the clipped binary image to the map</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>Map.addLayer(clipped_binary_image, {<span class="st">'palette'</span>: [<span class="st">'blue'</span>], <span class="st">'opacity'</span>: <span class="fl">0.5</span>}, <span class="st">'Flooded Pixels'</span>)</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Style for unit boundaries</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>units_style <span class="op">=</span> {<span class="st">'color'</span>: <span class="st">'red'</span>, <span class="st">'fillColor'</span>: <span class="st">'00000000'</span>}  <span class="co"># '00000000' is transparent in RGBA</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the unit boundaries to the map</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>Map.addLayer(units_with_calculations.style(<span class="op">**</span>units_style), {}, <span class="st">'Unit Boundaries'</span>)</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels to the map</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> units_with_calculations.aggregate_array(<span class="st">'label'</span>).getInfo()</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract centroids for each feature</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_centroid(feature):</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> feature.geometry().centroid().coordinates()</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>centroids <span class="op">=</span> units_with_calculations.<span class="bu">map</span>(<span class="kw">lambda</span> f: f.<span class="bu">set</span>(<span class="st">'centroid'</span>, get_centroid(f)))</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the centroids information</span></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>centroid_info <span class="op">=</span> centroids.aggregate_array(<span class="st">'centroid'</span>).getInfo()</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> label, centroid <span class="kw">in</span> <span class="bu">zip</span>(labels, centroid_info):</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>    folium.Marker(</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>        location<span class="op">=</span>[centroid[<span class="dv">1</span>], centroid[<span class="dv">0</span>]],</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>        icon<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>        popup<span class="op">=</span>label</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>    ).add_to(Map)</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the map with Layer Control</span></span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>Map.add_child(folium.LayerControl())</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the map to the subdirectory with a unique name</span></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>Map.save(map_filename)</span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>Map</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
<div class="cell-output cell-output-display" data-execution_count="50">

<iframe srcdoc="<!DOCTYPE html>
<html>
<head>
    
    <meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; />
    
        <script>
            L_NO_TOUCH = false;
            L_DISABLE_3D = false;
        </script>
    
    <style>html, body {width: 100%;height: 100%;margin: 0;padding: 0;}</style>
    <style>#map {position:absolute;top:0;bottom:0;right:0;left:0;}</style>
    <script src=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js&quot;></script>
    <script src=&quot;https://code.jquery.com/jquery-3.7.1.min.js&quot;></script>
    <script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js&quot;></script>
    <script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js&quot;></script>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css&quot;/>
    
            <meta name=&quot;viewport&quot; content=&quot;width=device-width,
                initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot; />
            <style>
                #map_68bcb25a4580ac4ed20ab72d2e69a2d0 {
                    position: relative;
                    width: 100.0%;
                    height: 100.0%;
                    left: 0.0%;
                    top: 0.0%;
                }
                .leaflet-container { font-size: 1rem; }
            </style>
        
    <script src=&quot;https://cdn.jsdelivr.net/npm/leaflet.fullscreen@3.0.0/Control.FullScreen.min.js&quot;></script>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet.fullscreen@3.0.0/Control.FullScreen.css&quot;/>
    <script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.2/leaflet.draw.js&quot;></script>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.2/leaflet.draw.css&quot;/>
    <script src=&quot;https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js&quot;></script>
    <link rel=&quot;stylesheet&quot; href=&quot;https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css&quot;/>
</head>
<body>
    
    
            <div class=&quot;folium-map&quot; id=&quot;map_68bcb25a4580ac4ed20ab72d2e69a2d0&quot; ></div>
        
</body>
<script>
    
    
            var map_68bcb25a4580ac4ed20ab72d2e69a2d0 = L.map(
                &quot;map_68bcb25a4580ac4ed20ab72d2e69a2d0&quot;,
                {
                    center: [36.8795, -118.202],
                    crs: L.CRS.EPSG3857,
                    zoom: 12,
                    zoomControl: true,
                    preferCanvas: false,
                    eeInitialize: true,
                    addGoogleMap: false,
                    pluginLatlngpopup: false,
                    pluginFullscreen: true,
                    pluginDraw: true,
                    DrawExport: false,
                    pluginMinimap: false,
                    locateControl: false,
                    searchControl: true,
                    layersControl: true,
                }
            );

            

        
    
            var tile_layer_58e9db7abb3e8cc2eb2b3a85ea9200ab = L.tileLayer(
                &quot;https://tile.openstreetmap.org/{z}/{x}/{y}.png&quot;,
                {&quot;attribution&quot;: &quot;\u0026copy; \u003ca href=\&quot;https://www.openstreetmap.org/copyright\&quot;\u003eOpenStreetMap\u003c/a\u003e contributors&quot;, &quot;detectRetina&quot;: false, &quot;maxNativeZoom&quot;: 19, &quot;maxZoom&quot;: 19, &quot;minZoom&quot;: 0, &quot;noWrap&quot;: false, &quot;opacity&quot;: 1, &quot;subdomains&quot;: &quot;abc&quot;, &quot;tms&quot;: false}
            );
        
    
            tile_layer_58e9db7abb3e8cc2eb2b3a85ea9200ab.addTo(map_68bcb25a4580ac4ed20ab72d2e69a2d0);
        
    
            L.control.fullscreen(
                {&quot;forceSeparateButton&quot;: false, &quot;position&quot;: &quot;topleft&quot;, &quot;title&quot;: &quot;Full Screen&quot;, &quot;titleCancel&quot;: &quot;Exit Full Screen&quot;}
            ).addTo(map_68bcb25a4580ac4ed20ab72d2e69a2d0);
        
    
            var options = {
              position: &quot;topleft&quot;,
              draw: {},
              edit: {},
            }
            // FeatureGroup is to store editable layers.
            var drawnItems_draw_control_c30c8536c5e6b23a1cb861f13bfc792f = new L.featureGroup().addTo(
                map_68bcb25a4580ac4ed20ab72d2e69a2d0
            );
            options.edit.featureGroup = drawnItems_draw_control_c30c8536c5e6b23a1cb861f13bfc792f;
            var draw_control_c30c8536c5e6b23a1cb861f13bfc792f = new L.Control.Draw(
                options
            ).addTo( map_68bcb25a4580ac4ed20ab72d2e69a2d0 );
            map_68bcb25a4580ac4ed20ab72d2e69a2d0.on(L.Draw.Event.CREATED, function(e) {
                var layer = e.layer,
                    type = e.layerType;
                var coords = JSON.stringify(layer.toGeoJSON());
                layer.on('click', function() {
                    alert(coords);
                    console.log(coords);
                });
                drawnItems_draw_control_c30c8536c5e6b23a1cb861f13bfc792f.addLayer(layer);
             });
            map_68bcb25a4580ac4ed20ab72d2e69a2d0.on('draw:created', function(e) {
                drawnItems_draw_control_c30c8536c5e6b23a1cb861f13bfc792f.addLayer(e.layer);
            });
            
        
    

            var geocoderOpts_geocoder_f3f346ada3087b5c47d5083cdb177c73 = {&quot;collapsed&quot;: true, &quot;defaultMarkGeocode&quot;: true, &quot;position&quot;: &quot;topleft&quot;, &quot;provider&quot;: &quot;nominatim&quot;, &quot;providerOptions&quot;: {}, &quot;zoom&quot;: 11};

            // note: geocoder name should start with lowercase
            var geocoderName_geocoder_f3f346ada3087b5c47d5083cdb177c73 = geocoderOpts_geocoder_f3f346ada3087b5c47d5083cdb177c73[&quot;provider&quot;];

            var customGeocoder_geocoder_f3f346ada3087b5c47d5083cdb177c73 = L.Control.Geocoder[ geocoderName_geocoder_f3f346ada3087b5c47d5083cdb177c73 ](
                geocoderOpts_geocoder_f3f346ada3087b5c47d5083cdb177c73['providerOptions']
            );
            geocoderOpts_geocoder_f3f346ada3087b5c47d5083cdb177c73[&quot;geocoder&quot;] = customGeocoder_geocoder_f3f346ada3087b5c47d5083cdb177c73;

            L.Control.geocoder(
                geocoderOpts_geocoder_f3f346ada3087b5c47d5083cdb177c73
            ).on('markgeocode', function(e) {
                var zoom = geocoderOpts_geocoder_f3f346ada3087b5c47d5083cdb177c73['zoom'] || map_68bcb25a4580ac4ed20ab72d2e69a2d0.getZoom();
                map_68bcb25a4580ac4ed20ab72d2e69a2d0.setView(e.geocode.center, zoom);
            }).addTo(map_68bcb25a4580ac4ed20ab72d2e69a2d0);

        
    
            map_68bcb25a4580ac4ed20ab72d2e69a2d0.fitBounds(
                [[36.8795, -118.202], [36.8795, -118.202]],
                {&quot;maxZoom&quot;: 12}
            );
        
    
            var tile_layer_1760588e2e558391987e64e44314d5fa = L.tileLayer(
                &quot;https://earthengine.googleapis.com/v1/projects/ee-icwd-2023/maps/9de840202feeda11994eefb1d8e4dc8e-65537491978dde8fae1da318e25810b6/tiles/{z}/{x}/{y}&quot;,
                {&quot;attribution&quot;: &quot;Google Earth Engine&quot;, &quot;detectRetina&quot;: false, &quot;maxNativeZoom&quot;: 24, &quot;maxZoom&quot;: 24, &quot;minZoom&quot;: 0, &quot;noWrap&quot;: false, &quot;opacity&quot;: 1.0, &quot;subdomains&quot;: &quot;abc&quot;, &quot;tms&quot;: false}
            );
        
    
            tile_layer_1760588e2e558391987e64e44314d5fa.addTo(map_68bcb25a4580ac4ed20ab72d2e69a2d0);
        
    
            var tile_layer_da8700b4ddd4ecce3a6392bd8dd39392 = L.tileLayer(
                &quot;https://earthengine.googleapis.com/v1/projects/ee-icwd-2023/maps/d7c681650ed142a46415375ef4d19930-27232c0154be846e64bebe897e2992a3/tiles/{z}/{x}/{y}&quot;,
                {&quot;attribution&quot;: &quot;Google Earth Engine&quot;, &quot;detectRetina&quot;: false, &quot;maxNativeZoom&quot;: 24, &quot;maxZoom&quot;: 24, &quot;minZoom&quot;: 0, &quot;noWrap&quot;: false, &quot;opacity&quot;: 1.0, &quot;subdomains&quot;: &quot;abc&quot;, &quot;tms&quot;: false}
            );
        
    
            tile_layer_da8700b4ddd4ecce3a6392bd8dd39392.addTo(map_68bcb25a4580ac4ed20ab72d2e69a2d0);
        
    
            var tile_layer_8358e200db3d498e0d76318d31bb752e = L.tileLayer(
                &quot;https://earthengine.googleapis.com/v1/projects/ee-icwd-2023/maps/ff6d8463cf6a87d799ec375a25f34496-9fa2c6121a7bfce2d4f517f190394741/tiles/{z}/{x}/{y}&quot;,
                {&quot;attribution&quot;: &quot;Google Earth Engine&quot;, &quot;detectRetina&quot;: false, &quot;maxNativeZoom&quot;: 24, &quot;maxZoom&quot;: 24, &quot;minZoom&quot;: 0, &quot;noWrap&quot;: false, &quot;opacity&quot;: 1.0, &quot;subdomains&quot;: &quot;abc&quot;, &quot;tms&quot;: false}
            );
        
    
            tile_layer_8358e200db3d498e0d76318d31bb752e.addTo(map_68bcb25a4580ac4ed20ab72d2e69a2d0);
        
    
            var marker_95c41b65655866bd164dbb9aa398ab43 = L.marker(
                [36.86044066484152, -118.19616961810209],
                {}
            ).addTo(map_68bcb25a4580ac4ed20ab72d2e69a2d0);
        
    
        var popup_0ff16497f6011f25fcf373d62e0eb6c6 = L.popup({&quot;maxWidth&quot;: &quot;100%&quot;});

        
            
                var html_ade5624968ba67518eac21705ccd6eab = $(`<div id=&quot;html_ade5624968ba67518eac21705ccd6eab&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Thibaut: 64.05 Acres</div>`)[0];
                popup_0ff16497f6011f25fcf373d62e0eb6c6.setContent(html_ade5624968ba67518eac21705ccd6eab);
            
        

        marker_95c41b65655866bd164dbb9aa398ab43.bindPopup(popup_0ff16497f6011f25fcf373d62e0eb6c6)
        ;

        
    
    
            var marker_a4fd78f14f3f43b4ee53d0c9e3a63d76 = L.marker(
                [36.91846697002981, -118.20809887168937],
                {}
            ).addTo(map_68bcb25a4580ac4ed20ab72d2e69a2d0);
        
    
        var popup_697ddd4e02bb5efa01ad69325f67652f = L.popup({&quot;maxWidth&quot;: &quot;100%&quot;});

        
            
                var html_0fd4effa115b82cab74a028a9ace171b = $(`<div id=&quot;html_0fd4effa115b82cab74a028a9ace171b&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Drew: 19.92 Acres</div>`)[0];
                popup_697ddd4e02bb5efa01ad69325f67652f.setContent(html_0fd4effa115b82cab74a028a9ace171b);
            
        

        marker_a4fd78f14f3f43b4ee53d0c9e3a63d76.bindPopup(popup_697ddd4e02bb5efa01ad69325f67652f)
        ;

        
    
    
            var marker_6ffe144e5408a5b39ab8ec9724f83cc0 = L.marker(
                [36.89979855072214, -118.19586436691745],
                {}
            ).addTo(map_68bcb25a4580ac4ed20ab72d2e69a2d0);
        
    
        var popup_96d3636ca85074c4f2d23c9449fd5c16 = L.popup({&quot;maxWidth&quot;: &quot;100%&quot;});

        
            
                var html_10892c87fab0b9677959398dfdb3a40b = $(`<div id=&quot;html_10892c87fab0b9677959398dfdb3a40b&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Waggonner: 30.00 Acres</div>`)[0];
                popup_96d3636ca85074c4f2d23c9449fd5c16.setContent(html_10892c87fab0b9677959398dfdb3a40b);
            
        

        marker_6ffe144e5408a5b39ab8ec9724f83cc0.bindPopup(popup_96d3636ca85074c4f2d23c9449fd5c16)
        ;

        
    
    
            var marker_4b99ae2ab1e48e4f7782fbab5b689033 = L.marker(
                [36.89781800267362, -118.21569918171215],
                {}
            ).addTo(map_68bcb25a4580ac4ed20ab72d2e69a2d0);
        
    
        var popup_a03fd8f6c4b559082c24829b9c3fb27a = L.popup({&quot;maxWidth&quot;: &quot;100%&quot;});

        
            
                var html_ed3f5b88dd075034aea591027e1c4d6c = $(`<div id=&quot;html_ed3f5b88dd075034aea591027e1c4d6c&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>West Winterton: 40.35 Acres</div>`)[0];
                popup_a03fd8f6c4b559082c24829b9c3fb27a.setContent(html_ed3f5b88dd075034aea591027e1c4d6c);
            
        

        marker_4b99ae2ab1e48e4f7782fbab5b689033.bindPopup(popup_a03fd8f6c4b559082c24829b9c3fb27a)
        ;

        
    
    
            var marker_62b534ab87bb233020c48285d5a7556d = L.marker(
                [36.90110531089543, -118.20920202369373],
                {}
            ).addTo(map_68bcb25a4580ac4ed20ab72d2e69a2d0);
        
    
        var popup_4b75019479bfb213387c1dba2386542d = L.popup({&quot;maxWidth&quot;: &quot;100%&quot;});

        
            
                var html_0f5a3eb63cc9730031900cc4fe675f97 = $(`<div id=&quot;html_0f5a3eb63cc9730031900cc4fe675f97&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>East Winterton: 0.22 Acres</div>`)[0];
                popup_4b75019479bfb213387c1dba2386542d.setContent(html_0f5a3eb63cc9730031900cc4fe675f97);
            
        

        marker_62b534ab87bb233020c48285d5a7556d.bindPopup(popup_4b75019479bfb213387c1dba2386542d)
        ;

        
    
    
            var marker_661e7448244dbb2a963430a5972e3dc6 = L.marker(
                [36.878012701624925, -118.20090485228432],
                {}
            ).addTo(map_68bcb25a4580ac4ed20ab72d2e69a2d0);
        
    
        var popup_3b85a01f9a04e40f9a3711c1de5c80de = L.popup({&quot;maxWidth&quot;: &quot;100%&quot;});

        
            
                var html_b98cc0ef95fe0cab25b296ae88f9c161 = $(`<div id=&quot;html_b98cc0ef95fe0cab25b296ae88f9c161&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>South Winterton: 0.77 Acres</div>`)[0];
                popup_3b85a01f9a04e40f9a3711c1de5c80de.setContent(html_b98cc0ef95fe0cab25b296ae88f9c161);
            
        

        marker_661e7448244dbb2a963430a5972e3dc6.bindPopup(popup_3b85a01f9a04e40f9a3711c1de5c80de)
        ;

        
    
    
            var marker_9a10be889052e6a11efa189427be7dbb = L.marker(
                [36.87867846980565, -118.21664203614019],
                {}
            ).addTo(map_68bcb25a4580ac4ed20ab72d2e69a2d0);
        
    
        var popup_a9bb91578b33bbeacccc41d39b955eb6 = L.popup({&quot;maxWidth&quot;: &quot;100%&quot;});

        
            
                var html_91d847cc290b2ee03274808785fa18f6 = $(`<div id=&quot;html_91d847cc290b2ee03274808785fa18f6&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Thibaut Ponds: 12.45 Acres</div>`)[0];
                popup_a9bb91578b33bbeacccc41d39b955eb6.setContent(html_91d847cc290b2ee03274808785fa18f6);
            
        

        marker_9a10be889052e6a11efa189427be7dbb.bindPopup(popup_a9bb91578b33bbeacccc41d39b955eb6)
        ;

        
    
    
            var layer_control_1b234268b2754341b83dde9fd44b4b9f_layers = {
                base_layers : {
                    &quot;openstreetmap&quot; : tile_layer_58e9db7abb3e8cc2eb2b3a85ea9200ab,
                },
                overlays :  {
                    &quot;False-Color Composite&quot; : tile_layer_1760588e2e558391987e64e44314d5fa,
                    &quot;Flooded Pixels&quot; : tile_layer_da8700b4ddd4ecce3a6392bd8dd39392,
                    &quot;Unit Boundaries&quot; : tile_layer_8358e200db3d498e0d76318d31bb752e,
                },
            };
            let layer_control_1b234268b2754341b83dde9fd44b4b9f = L.control.layers(
                layer_control_1b234268b2754341b83dde9fd44b4b9f_layers.base_layers,
                layer_control_1b234268b2754341b83dde9fd44b4b9f_layers.overlays,
                {&quot;autoZIndex&quot;: true, &quot;collapsed&quot;: true, &quot;position&quot;: &quot;topright&quot;}
            ).addTo(map_68bcb25a4580ac4ed20ab72d2e69a2d0);

        
    
            tile_layer_58e9db7abb3e8cc2eb2b3a85ea9200ab.addTo(map_68bcb25a4580ac4ed20ab72d2e69a2d0);
        
    
            tile_layer_1760588e2e558391987e64e44314d5fa.addTo(map_68bcb25a4580ac4ed20ab72d2e69a2d0);
        
    
            tile_layer_da8700b4ddd4ecce3a6392bd8dd39392.addTo(map_68bcb25a4580ac4ed20ab72d2e69a2d0);
        
    
            tile_layer_8358e200db3d498e0d76318d31bb752e.addTo(map_68bcb25a4580ac4ed20ab72d2e69a2d0);
        
</script>
</html>" width="100%" height="600" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"=""></iframe>
</div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>false_color_vis <span class="op">=</span> {</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'min'</span>: <span class="dv">0</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max'</span>: <span class="dv">3000</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'bands'</span>: [<span class="st">'B11'</span>, <span class="st">'B8'</span>, <span class="st">'B4'</span>],  <span class="co"># SWIR1 (B11), NIR (B8), Red (B4)</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'gamma'</span>: <span class="fl">1.4</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the Sentinel-2 image collection filtered by date, cloud cover, and bounds</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>sentinel_collection <span class="op">=</span> ee.ImageCollection(<span class="st">'COPERNICUS/S2_SR_HARMONIZED'</span>) <span class="op">\</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    .filterBounds(bounding_box_geometry) <span class="op">\</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    .filterDate(start_date, end_date) <span class="op">\</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(ee.Filter.lt(<span class="st">'CLOUDY_PIXEL_PERCENTAGE'</span>, <span class="dv">30</span>)) <span class="op">\</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    .select([<span class="st">'B8'</span>, <span class="st">'B11'</span>, <span class="st">'B4'</span>, <span class="st">'SCL'</span>])  <span class="co"># Select NIR (B8), SWIR1 (B11), Red (B4), and Scene Classification Layer (SCL)</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Clip the binary image to the unit boundaries</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>clipped_binary_image <span class="op">=</span> binary_image.clip(units)</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a folium map</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>Map <span class="op">=</span> geemap.Map(center<span class="op">=</span>[<span class="fl">36.8795</span>, <span class="op">-</span><span class="fl">118.202</span>], zoom<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the false-color image to the map (assuming 'image' is your Sentinel-2 or equivalent image)</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>Map.addLayer(image, false_color_vis, <span class="st">'False-Color Composite'</span>)</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the clipped binary image to the map</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>Map.addLayer(clipped_binary_image, {<span class="st">'palette'</span>: [<span class="st">'blue'</span>], <span class="st">'opacity'</span>: <span class="fl">0.5</span>}, <span class="st">'Flooded Pixels'</span>)</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Style for unit boundaries</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>units_style <span class="op">=</span> {<span class="st">'color'</span>: <span class="st">'red'</span>, <span class="st">'fillColor'</span>: <span class="st">'00000000'</span>}  <span class="co"># '00000000' is transparent in RGBA</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the unit boundaries to the map</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>Map.addLayer(units_with_calculations.style(<span class="op">**</span>units_style), {}, <span class="st">'Unit Boundaries'</span>)</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels to the map</span></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> units_with_calculations.aggregate_array(<span class="st">'label'</span>).getInfo()</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract centroids for each feature</span></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_centroid(feature):</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> feature.geometry().centroid().coordinates()</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>centroids <span class="op">=</span> units_with_calculations.<span class="bu">map</span>(<span class="kw">lambda</span> f: f.<span class="bu">set</span>(<span class="st">'centroid'</span>, get_centroid(f)))</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the centroids information</span></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>centroid_info <span class="op">=</span> centroids.aggregate_array(<span class="st">'centroid'</span>).getInfo()</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> label, centroid <span class="kw">in</span> <span class="bu">zip</span>(labels, centroid_info):</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>    folium.Marker(</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>        location<span class="op">=</span>[centroid[<span class="dv">1</span>], centroid[<span class="dv">0</span>]],</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>        icon<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>        popup<span class="op">=</span>label</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>    ).add_to(Map)</span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the map with Layer Control</span></span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>Map.add_child(folium.LayerControl())</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the map to the subdirectory with a unique name</span></span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>Map.save(map_filename)</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>Map</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'image' is not defined</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clip the binary image to the unit boundaries</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>clipped_binary_image <span class="op">=</span> binary_image.clip(units)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a folium map</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Map <span class="op">=</span> geemap.Map(center<span class="op">=</span>[<span class="fl">36.8795</span>, <span class="op">-</span><span class="fl">118.202</span>], zoom<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the clipped binary image to the map</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>Map.addLayer(clipped_binary_image, {<span class="st">'palette'</span>: [<span class="st">'blue'</span>], <span class="st">'opacity'</span>: <span class="fl">0.5</span>}, <span class="st">'Flooded Pixels'</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Style for unit boundaries</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>units_style <span class="op">=</span> {<span class="st">'color'</span>: <span class="st">'red'</span>, <span class="st">'fillColor'</span>: <span class="st">'00000000'</span>}  <span class="co"># '00000000' is transparent in RGBA</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the unit boundaries to the map</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>Map.addLayer(units_with_calculations.style(<span class="op">**</span>units_style), {}, <span class="st">'Unit Boundaries'</span>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels to the map</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> units_with_calculations.aggregate_array(<span class="st">'label'</span>).getInfo()</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract centroids for each feature</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_centroid(feature):</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> feature.geometry().centroid().coordinates()</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>centroids <span class="op">=</span> units_with_calculations.<span class="bu">map</span>(<span class="kw">lambda</span> f: f.<span class="bu">set</span>(<span class="st">'centroid'</span>, get_centroid(f)))</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the centroids information</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>centroid_info <span class="op">=</span> centroids.aggregate_array(<span class="st">'centroid'</span>).getInfo()</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> label, centroid <span class="kw">in</span> <span class="bu">zip</span>(labels, centroid_info):</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>    folium.Marker(</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>        location<span class="op">=</span>[centroid[<span class="dv">1</span>], centroid[<span class="dv">0</span>]],</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>        icon<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>        popup<span class="op">=</span>label</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>    ).add_to(Map)</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the map</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>Map.add_child(folium.LayerControl())</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the map to the subdirectory with a unique name</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>Map.save(map_filename)</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>Map</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
<div class="cell-output cell-output-display">

<iframe srcdoc="<!DOCTYPE html>
<html>
<head>
    
    <meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; />
    
        <script>
            L_NO_TOUCH = false;
            L_DISABLE_3D = false;
        </script>
    
    <style>html, body {width: 100%;height: 100%;margin: 0;padding: 0;}</style>
    <style>#map {position:absolute;top:0;bottom:0;right:0;left:0;}</style>
    <script src=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js&quot;></script>
    <script src=&quot;https://code.jquery.com/jquery-3.7.1.min.js&quot;></script>
    <script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js&quot;></script>
    <script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js&quot;></script>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css&quot;/>
    
            <meta name=&quot;viewport&quot; content=&quot;width=device-width,
                initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot; />
            <style>
                #map_627d572cfc8aa660541755980b16d5b8 {
                    position: relative;
                    width: 100.0%;
                    height: 100.0%;
                    left: 0.0%;
                    top: 0.0%;
                }
                .leaflet-container { font-size: 1rem; }
            </style>
        
    <script src=&quot;https://cdn.jsdelivr.net/npm/leaflet.fullscreen@3.0.0/Control.FullScreen.min.js&quot;></script>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet.fullscreen@3.0.0/Control.FullScreen.css&quot;/>
    <script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.2/leaflet.draw.js&quot;></script>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.2/leaflet.draw.css&quot;/>
    <script src=&quot;https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js&quot;></script>
    <link rel=&quot;stylesheet&quot; href=&quot;https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css&quot;/>
</head>
<body>
    
    
            <div class=&quot;folium-map&quot; id=&quot;map_627d572cfc8aa660541755980b16d5b8&quot; ></div>
        
</body>
<script>
    
    
            var map_627d572cfc8aa660541755980b16d5b8 = L.map(
                &quot;map_627d572cfc8aa660541755980b16d5b8&quot;,
                {
                    center: [36.8795, -118.202],
                    crs: L.CRS.EPSG3857,
                    zoom: 12,
                    zoomControl: true,
                    preferCanvas: false,
                    eeInitialize: true,
                    addGoogleMap: false,
                    pluginLatlngpopup: false,
                    pluginFullscreen: true,
                    pluginDraw: true,
                    DrawExport: false,
                    pluginMinimap: false,
                    locateControl: false,
                    searchControl: true,
                    layersControl: true,
                }
            );

            

        
    
            var tile_layer_42711bafc96c20d9823890e78aeb40e6 = L.tileLayer(
                &quot;https://tile.openstreetmap.org/{z}/{x}/{y}.png&quot;,
                {&quot;attribution&quot;: &quot;\u0026copy; \u003ca href=\&quot;https://www.openstreetmap.org/copyright\&quot;\u003eOpenStreetMap\u003c/a\u003e contributors&quot;, &quot;detectRetina&quot;: false, &quot;maxNativeZoom&quot;: 19, &quot;maxZoom&quot;: 19, &quot;minZoom&quot;: 0, &quot;noWrap&quot;: false, &quot;opacity&quot;: 1, &quot;subdomains&quot;: &quot;abc&quot;, &quot;tms&quot;: false}
            );
        
    
            tile_layer_42711bafc96c20d9823890e78aeb40e6.addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
            L.control.fullscreen(
                {&quot;forceSeparateButton&quot;: false, &quot;position&quot;: &quot;topleft&quot;, &quot;title&quot;: &quot;Full Screen&quot;, &quot;titleCancel&quot;: &quot;Exit Full Screen&quot;}
            ).addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
            var options = {
              position: &quot;topleft&quot;,
              draw: {},
              edit: {},
            }
            // FeatureGroup is to store editable layers.
            var drawnItems_draw_control_354ce9ccbc70a56456264d10c3c366c9 = new L.featureGroup().addTo(
                map_627d572cfc8aa660541755980b16d5b8
            );
            options.edit.featureGroup = drawnItems_draw_control_354ce9ccbc70a56456264d10c3c366c9;
            var draw_control_354ce9ccbc70a56456264d10c3c366c9 = new L.Control.Draw(
                options
            ).addTo( map_627d572cfc8aa660541755980b16d5b8 );
            map_627d572cfc8aa660541755980b16d5b8.on(L.Draw.Event.CREATED, function(e) {
                var layer = e.layer,
                    type = e.layerType;
                var coords = JSON.stringify(layer.toGeoJSON());
                layer.on('click', function() {
                    alert(coords);
                    console.log(coords);
                });
                drawnItems_draw_control_354ce9ccbc70a56456264d10c3c366c9.addLayer(layer);
             });
            map_627d572cfc8aa660541755980b16d5b8.on('draw:created', function(e) {
                drawnItems_draw_control_354ce9ccbc70a56456264d10c3c366c9.addLayer(e.layer);
            });
            
        
    

            var geocoderOpts_geocoder_cb1c547e54ef447a304308ecae69ffc8 = {&quot;collapsed&quot;: true, &quot;defaultMarkGeocode&quot;: true, &quot;position&quot;: &quot;topleft&quot;, &quot;provider&quot;: &quot;nominatim&quot;, &quot;providerOptions&quot;: {}, &quot;zoom&quot;: 11};

            // note: geocoder name should start with lowercase
            var geocoderName_geocoder_cb1c547e54ef447a304308ecae69ffc8 = geocoderOpts_geocoder_cb1c547e54ef447a304308ecae69ffc8[&quot;provider&quot;];

            var customGeocoder_geocoder_cb1c547e54ef447a304308ecae69ffc8 = L.Control.Geocoder[ geocoderName_geocoder_cb1c547e54ef447a304308ecae69ffc8 ](
                geocoderOpts_geocoder_cb1c547e54ef447a304308ecae69ffc8['providerOptions']
            );
            geocoderOpts_geocoder_cb1c547e54ef447a304308ecae69ffc8[&quot;geocoder&quot;] = customGeocoder_geocoder_cb1c547e54ef447a304308ecae69ffc8;

            L.Control.geocoder(
                geocoderOpts_geocoder_cb1c547e54ef447a304308ecae69ffc8
            ).on('markgeocode', function(e) {
                var zoom = geocoderOpts_geocoder_cb1c547e54ef447a304308ecae69ffc8['zoom'] || map_627d572cfc8aa660541755980b16d5b8.getZoom();
                map_627d572cfc8aa660541755980b16d5b8.setView(e.geocode.center, zoom);
            }).addTo(map_627d572cfc8aa660541755980b16d5b8);

        
    
            map_627d572cfc8aa660541755980b16d5b8.fitBounds(
                [[36.8795, -118.202], [36.8795, -118.202]],
                {&quot;maxZoom&quot;: 12}
            );
        
    
            var tile_layer_7fc230a1a7b190c1da0b1538fa14e294 = L.tileLayer(
                &quot;https://earthengine.googleapis.com/v1/projects/ee-icwd-2023/maps/d60854cfcdc3fdef1815fc9c62e55e21-93e342533442f1feb0bed5277baa0d1c/tiles/{z}/{x}/{y}&quot;,
                {&quot;attribution&quot;: &quot;Google Earth Engine&quot;, &quot;detectRetina&quot;: false, &quot;maxNativeZoom&quot;: 24, &quot;maxZoom&quot;: 24, &quot;minZoom&quot;: 0, &quot;noWrap&quot;: false, &quot;opacity&quot;: 1.0, &quot;subdomains&quot;: &quot;abc&quot;, &quot;tms&quot;: false}
            );
        
    
            tile_layer_7fc230a1a7b190c1da0b1538fa14e294.addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
            var tile_layer_3694564b2dbae984a7dfcf82feca929f = L.tileLayer(
                &quot;https://earthengine.googleapis.com/v1/projects/ee-icwd-2023/maps/23a0ed8ecad8b8ea00012aca62ed1c38-90e335e22e332f65cb5fdf1abb5e852c/tiles/{z}/{x}/{y}&quot;,
                {&quot;attribution&quot;: &quot;Google Earth Engine&quot;, &quot;detectRetina&quot;: false, &quot;maxNativeZoom&quot;: 24, &quot;maxZoom&quot;: 24, &quot;minZoom&quot;: 0, &quot;noWrap&quot;: false, &quot;opacity&quot;: 1.0, &quot;subdomains&quot;: &quot;abc&quot;, &quot;tms&quot;: false}
            );
        
    
            tile_layer_3694564b2dbae984a7dfcf82feca929f.addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
            var marker_63a7b8ff6d3ca2418cca205c57447cb7 = L.marker(
                [36.86044066484152, -118.19616961810209],
                {}
            ).addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
        var popup_3522bd0072f8a7f3f9ce3f9c2fbe53a8 = L.popup({&quot;maxWidth&quot;: &quot;100%&quot;});

        
            
                var html_ef0c6a773377a93f806b61cf3ff8bcd4 = $(`<div id=&quot;html_ef0c6a773377a93f806b61cf3ff8bcd4&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Thibaut: 64.05 Acres</div>`)[0];
                popup_3522bd0072f8a7f3f9ce3f9c2fbe53a8.setContent(html_ef0c6a773377a93f806b61cf3ff8bcd4);
            
        

        marker_63a7b8ff6d3ca2418cca205c57447cb7.bindPopup(popup_3522bd0072f8a7f3f9ce3f9c2fbe53a8)
        ;

        
    
    
            var marker_ba6940245e5eba7f2b34d20b41e1ff90 = L.marker(
                [36.91846697002981, -118.20809887168937],
                {}
            ).addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
        var popup_f5fb856cee50414b6bd960245f218441 = L.popup({&quot;maxWidth&quot;: &quot;100%&quot;});

        
            
                var html_aa9bde408adcce333a81407af668c1e3 = $(`<div id=&quot;html_aa9bde408adcce333a81407af668c1e3&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Drew: 19.92 Acres</div>`)[0];
                popup_f5fb856cee50414b6bd960245f218441.setContent(html_aa9bde408adcce333a81407af668c1e3);
            
        

        marker_ba6940245e5eba7f2b34d20b41e1ff90.bindPopup(popup_f5fb856cee50414b6bd960245f218441)
        ;

        
    
    
            var marker_ab4eaa9c553f9d6aff08bbb6e4c05e7d = L.marker(
                [36.89979855072214, -118.19586436691745],
                {}
            ).addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
        var popup_0f86d28baa400470436dc4e615b51eac = L.popup({&quot;maxWidth&quot;: &quot;100%&quot;});

        
            
                var html_bdb7d60e2ed009b02e55c2b7e6e479c4 = $(`<div id=&quot;html_bdb7d60e2ed009b02e55c2b7e6e479c4&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Waggonner: 30.00 Acres</div>`)[0];
                popup_0f86d28baa400470436dc4e615b51eac.setContent(html_bdb7d60e2ed009b02e55c2b7e6e479c4);
            
        

        marker_ab4eaa9c553f9d6aff08bbb6e4c05e7d.bindPopup(popup_0f86d28baa400470436dc4e615b51eac)
        ;

        
    
    
            var marker_696823d8e9ebc3e7643967d03df8066f = L.marker(
                [36.89781800267362, -118.21569918171215],
                {}
            ).addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
        var popup_6229292ded127022c0f78451aa3bf8e6 = L.popup({&quot;maxWidth&quot;: &quot;100%&quot;});

        
            
                var html_2d55c2d09fc8b389f8f0eaca16e1aba6 = $(`<div id=&quot;html_2d55c2d09fc8b389f8f0eaca16e1aba6&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>West Winterton: 40.35 Acres</div>`)[0];
                popup_6229292ded127022c0f78451aa3bf8e6.setContent(html_2d55c2d09fc8b389f8f0eaca16e1aba6);
            
        

        marker_696823d8e9ebc3e7643967d03df8066f.bindPopup(popup_6229292ded127022c0f78451aa3bf8e6)
        ;

        
    
    
            var marker_5a2b5e662169c8e91b1fb717a5b9f772 = L.marker(
                [36.90110531089543, -118.20920202369373],
                {}
            ).addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
        var popup_94babad2a9c23c5238e06db93414a62c = L.popup({&quot;maxWidth&quot;: &quot;100%&quot;});

        
            
                var html_70d549ca73d2327819b51ad548bcb4a3 = $(`<div id=&quot;html_70d549ca73d2327819b51ad548bcb4a3&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>East Winterton: 0.22 Acres</div>`)[0];
                popup_94babad2a9c23c5238e06db93414a62c.setContent(html_70d549ca73d2327819b51ad548bcb4a3);
            
        

        marker_5a2b5e662169c8e91b1fb717a5b9f772.bindPopup(popup_94babad2a9c23c5238e06db93414a62c)
        ;

        
    
    
            var marker_2b410129869c9dff6ea161180d4ba0ee = L.marker(
                [36.878012701624925, -118.20090485228432],
                {}
            ).addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
        var popup_4f992b15a5fe57a72d95eea6eab9b09f = L.popup({&quot;maxWidth&quot;: &quot;100%&quot;});

        
            
                var html_02ff9f0803c7f94749c4ee29726abcb4 = $(`<div id=&quot;html_02ff9f0803c7f94749c4ee29726abcb4&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>South Winterton: 0.77 Acres</div>`)[0];
                popup_4f992b15a5fe57a72d95eea6eab9b09f.setContent(html_02ff9f0803c7f94749c4ee29726abcb4);
            
        

        marker_2b410129869c9dff6ea161180d4ba0ee.bindPopup(popup_4f992b15a5fe57a72d95eea6eab9b09f)
        ;

        
    
    
            var marker_e8babc668e1068210f4ab06bda30cc25 = L.marker(
                [36.87867846980565, -118.21664203614019],
                {}
            ).addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
        var popup_b5bc9350fb02b15244d9dc2664789319 = L.popup({&quot;maxWidth&quot;: &quot;100%&quot;});

        
            
                var html_2d608b2216f7d4325be7cd86c8046e2b = $(`<div id=&quot;html_2d608b2216f7d4325be7cd86c8046e2b&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Thibaut Ponds: 12.45 Acres</div>`)[0];
                popup_b5bc9350fb02b15244d9dc2664789319.setContent(html_2d608b2216f7d4325be7cd86c8046e2b);
            
        

        marker_e8babc668e1068210f4ab06bda30cc25.bindPopup(popup_b5bc9350fb02b15244d9dc2664789319)
        ;

        
    
    
            var layer_control_37fa84f125578758dde4770be39cdc8d_layers = {
                base_layers : {
                    &quot;openstreetmap&quot; : tile_layer_42711bafc96c20d9823890e78aeb40e6,
                },
                overlays :  {
                    &quot;Flooded Pixels&quot; : tile_layer_7fc230a1a7b190c1da0b1538fa14e294,
                    &quot;Unit Boundaries&quot; : tile_layer_3694564b2dbae984a7dfcf82feca929f,
                },
            };
            let layer_control_37fa84f125578758dde4770be39cdc8d = L.control.layers(
                layer_control_37fa84f125578758dde4770be39cdc8d_layers.base_layers,
                layer_control_37fa84f125578758dde4770be39cdc8d_layers.overlays,
                {&quot;autoZIndex&quot;: true, &quot;collapsed&quot;: true, &quot;position&quot;: &quot;topright&quot;}
            ).addTo(map_627d572cfc8aa660541755980b16d5b8);

        
    
            tile_layer_42711bafc96c20d9823890e78aeb40e6.addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
            tile_layer_7fc230a1a7b190c1da0b1538fa14e294.addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
            tile_layer_3694564b2dbae984a7dfcf82feca929f.addTo(map_627d572cfc8aa660541755980b16d5b8);
        
</script>
</html>" width="100%" height="600" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"=""></iframe>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clip the binary image to the unit boundaries</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>clipped_binary_image <span class="op">=</span> binary_image.clip(units)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a folium map</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>Map <span class="op">=</span> geemap.Map(center<span class="op">=</span>[<span class="fl">36.8795</span>, <span class="op">-</span><span class="fl">118.202</span>], zoom<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the clipped binary image to the map</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>Map.addLayer(clipped_binary_image, {<span class="st">'palette'</span>: [<span class="st">'blue'</span>], <span class="st">'opacity'</span>: <span class="fl">0.5</span>}, <span class="st">'Flooded Pixels'</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Style for unit boundaries</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>units_style <span class="op">=</span> {<span class="st">'color'</span>: <span class="st">'red'</span>, <span class="st">'fillColor'</span>: <span class="st">'00000000'</span>}  <span class="co"># '00000000' is transparent in RGBA</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the unit boundaries to the map</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>Map.addLayer(units_with_calculations.style(<span class="op">**</span>units_style), {}, <span class="st">'Unit Boundaries'</span>)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels to the map</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> units_with_calculations.aggregate_array(<span class="st">'label'</span>).getInfo()</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract centroids for each feature</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_centroid(feature):</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> feature.geometry().centroid().coordinates()</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>centroids <span class="op">=</span> units_with_calculations.<span class="bu">map</span>(<span class="kw">lambda</span> f: f.<span class="bu">set</span>(<span class="st">'centroid'</span>, get_centroid(f)))</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the centroids information</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>centroid_info <span class="op">=</span> centroids.aggregate_array(<span class="st">'centroid'</span>).getInfo()</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> label, centroid <span class="kw">in</span> <span class="bu">zip</span>(labels, centroid_info):</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>    folium.Marker(</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>        location<span class="op">=</span>[centroid[<span class="dv">1</span>], centroid[<span class="dv">0</span>]],</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>        icon<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>        popup<span class="op">=</span>label</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>    ).add_to(Map)</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the map</span></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>Map.add_child(folium.LayerControl())</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the map to the subdirectory with a unique name</span></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>Map.save(map_filename)</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>Map</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
<div class="cell-output cell-output-display" data-execution_count="34">

<iframe srcdoc="<!DOCTYPE html>
<html>
<head>
    
    <meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; />
    
        <script>
            L_NO_TOUCH = false;
            L_DISABLE_3D = false;
        </script>
    
    <style>html, body {width: 100%;height: 100%;margin: 0;padding: 0;}</style>
    <style>#map {position:absolute;top:0;bottom:0;right:0;left:0;}</style>
    <script src=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js&quot;></script>
    <script src=&quot;https://code.jquery.com/jquery-3.7.1.min.js&quot;></script>
    <script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js&quot;></script>
    <script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js&quot;></script>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css&quot;/>
    
            <meta name=&quot;viewport&quot; content=&quot;width=device-width,
                initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot; />
            <style>
                #map_627d572cfc8aa660541755980b16d5b8 {
                    position: relative;
                    width: 100.0%;
                    height: 100.0%;
                    left: 0.0%;
                    top: 0.0%;
                }
                .leaflet-container { font-size: 1rem; }
            </style>
        
    <script src=&quot;https://cdn.jsdelivr.net/npm/leaflet.fullscreen@3.0.0/Control.FullScreen.min.js&quot;></script>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet.fullscreen@3.0.0/Control.FullScreen.css&quot;/>
    <script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.2/leaflet.draw.js&quot;></script>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.2/leaflet.draw.css&quot;/>
    <script src=&quot;https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js&quot;></script>
    <link rel=&quot;stylesheet&quot; href=&quot;https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css&quot;/>
</head>
<body>
    
    
            <div class=&quot;folium-map&quot; id=&quot;map_627d572cfc8aa660541755980b16d5b8&quot; ></div>
        
</body>
<script>
    
    
            var map_627d572cfc8aa660541755980b16d5b8 = L.map(
                &quot;map_627d572cfc8aa660541755980b16d5b8&quot;,
                {
                    center: [36.8795, -118.202],
                    crs: L.CRS.EPSG3857,
                    zoom: 12,
                    zoomControl: true,
                    preferCanvas: false,
                    eeInitialize: true,
                    addGoogleMap: false,
                    pluginLatlngpopup: false,
                    pluginFullscreen: true,
                    pluginDraw: true,
                    DrawExport: false,
                    pluginMinimap: false,
                    locateControl: false,
                    searchControl: true,
                    layersControl: true,
                }
            );

            

        
    
            var tile_layer_42711bafc96c20d9823890e78aeb40e6 = L.tileLayer(
                &quot;https://tile.openstreetmap.org/{z}/{x}/{y}.png&quot;,
                {&quot;attribution&quot;: &quot;\u0026copy; \u003ca href=\&quot;https://www.openstreetmap.org/copyright\&quot;\u003eOpenStreetMap\u003c/a\u003e contributors&quot;, &quot;detectRetina&quot;: false, &quot;maxNativeZoom&quot;: 19, &quot;maxZoom&quot;: 19, &quot;minZoom&quot;: 0, &quot;noWrap&quot;: false, &quot;opacity&quot;: 1, &quot;subdomains&quot;: &quot;abc&quot;, &quot;tms&quot;: false}
            );
        
    
            tile_layer_42711bafc96c20d9823890e78aeb40e6.addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
            L.control.fullscreen(
                {&quot;forceSeparateButton&quot;: false, &quot;position&quot;: &quot;topleft&quot;, &quot;title&quot;: &quot;Full Screen&quot;, &quot;titleCancel&quot;: &quot;Exit Full Screen&quot;}
            ).addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
            var options = {
              position: &quot;topleft&quot;,
              draw: {},
              edit: {},
            }
            // FeatureGroup is to store editable layers.
            var drawnItems_draw_control_354ce9ccbc70a56456264d10c3c366c9 = new L.featureGroup().addTo(
                map_627d572cfc8aa660541755980b16d5b8
            );
            options.edit.featureGroup = drawnItems_draw_control_354ce9ccbc70a56456264d10c3c366c9;
            var draw_control_354ce9ccbc70a56456264d10c3c366c9 = new L.Control.Draw(
                options
            ).addTo( map_627d572cfc8aa660541755980b16d5b8 );
            map_627d572cfc8aa660541755980b16d5b8.on(L.Draw.Event.CREATED, function(e) {
                var layer = e.layer,
                    type = e.layerType;
                var coords = JSON.stringify(layer.toGeoJSON());
                layer.on('click', function() {
                    alert(coords);
                    console.log(coords);
                });
                drawnItems_draw_control_354ce9ccbc70a56456264d10c3c366c9.addLayer(layer);
             });
            map_627d572cfc8aa660541755980b16d5b8.on('draw:created', function(e) {
                drawnItems_draw_control_354ce9ccbc70a56456264d10c3c366c9.addLayer(e.layer);
            });
            
        
    

            var geocoderOpts_geocoder_cb1c547e54ef447a304308ecae69ffc8 = {&quot;collapsed&quot;: true, &quot;defaultMarkGeocode&quot;: true, &quot;position&quot;: &quot;topleft&quot;, &quot;provider&quot;: &quot;nominatim&quot;, &quot;providerOptions&quot;: {}, &quot;zoom&quot;: 11};

            // note: geocoder name should start with lowercase
            var geocoderName_geocoder_cb1c547e54ef447a304308ecae69ffc8 = geocoderOpts_geocoder_cb1c547e54ef447a304308ecae69ffc8[&quot;provider&quot;];

            var customGeocoder_geocoder_cb1c547e54ef447a304308ecae69ffc8 = L.Control.Geocoder[ geocoderName_geocoder_cb1c547e54ef447a304308ecae69ffc8 ](
                geocoderOpts_geocoder_cb1c547e54ef447a304308ecae69ffc8['providerOptions']
            );
            geocoderOpts_geocoder_cb1c547e54ef447a304308ecae69ffc8[&quot;geocoder&quot;] = customGeocoder_geocoder_cb1c547e54ef447a304308ecae69ffc8;

            L.Control.geocoder(
                geocoderOpts_geocoder_cb1c547e54ef447a304308ecae69ffc8
            ).on('markgeocode', function(e) {
                var zoom = geocoderOpts_geocoder_cb1c547e54ef447a304308ecae69ffc8['zoom'] || map_627d572cfc8aa660541755980b16d5b8.getZoom();
                map_627d572cfc8aa660541755980b16d5b8.setView(e.geocode.center, zoom);
            }).addTo(map_627d572cfc8aa660541755980b16d5b8);

        
    
            map_627d572cfc8aa660541755980b16d5b8.fitBounds(
                [[36.8795, -118.202], [36.8795, -118.202]],
                {&quot;maxZoom&quot;: 12}
            );
        
    
            var tile_layer_7fc230a1a7b190c1da0b1538fa14e294 = L.tileLayer(
                &quot;https://earthengine.googleapis.com/v1/projects/ee-icwd-2023/maps/d60854cfcdc3fdef1815fc9c62e55e21-93e342533442f1feb0bed5277baa0d1c/tiles/{z}/{x}/{y}&quot;,
                {&quot;attribution&quot;: &quot;Google Earth Engine&quot;, &quot;detectRetina&quot;: false, &quot;maxNativeZoom&quot;: 24, &quot;maxZoom&quot;: 24, &quot;minZoom&quot;: 0, &quot;noWrap&quot;: false, &quot;opacity&quot;: 1.0, &quot;subdomains&quot;: &quot;abc&quot;, &quot;tms&quot;: false}
            );
        
    
            tile_layer_7fc230a1a7b190c1da0b1538fa14e294.addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
            var tile_layer_3694564b2dbae984a7dfcf82feca929f = L.tileLayer(
                &quot;https://earthengine.googleapis.com/v1/projects/ee-icwd-2023/maps/23a0ed8ecad8b8ea00012aca62ed1c38-90e335e22e332f65cb5fdf1abb5e852c/tiles/{z}/{x}/{y}&quot;,
                {&quot;attribution&quot;: &quot;Google Earth Engine&quot;, &quot;detectRetina&quot;: false, &quot;maxNativeZoom&quot;: 24, &quot;maxZoom&quot;: 24, &quot;minZoom&quot;: 0, &quot;noWrap&quot;: false, &quot;opacity&quot;: 1.0, &quot;subdomains&quot;: &quot;abc&quot;, &quot;tms&quot;: false}
            );
        
    
            tile_layer_3694564b2dbae984a7dfcf82feca929f.addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
            var marker_63a7b8ff6d3ca2418cca205c57447cb7 = L.marker(
                [36.86044066484152, -118.19616961810209],
                {}
            ).addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
        var popup_3522bd0072f8a7f3f9ce3f9c2fbe53a8 = L.popup({&quot;maxWidth&quot;: &quot;100%&quot;});

        
            
                var html_ef0c6a773377a93f806b61cf3ff8bcd4 = $(`<div id=&quot;html_ef0c6a773377a93f806b61cf3ff8bcd4&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Thibaut: 64.05 Acres</div>`)[0];
                popup_3522bd0072f8a7f3f9ce3f9c2fbe53a8.setContent(html_ef0c6a773377a93f806b61cf3ff8bcd4);
            
        

        marker_63a7b8ff6d3ca2418cca205c57447cb7.bindPopup(popup_3522bd0072f8a7f3f9ce3f9c2fbe53a8)
        ;

        
    
    
            var marker_ba6940245e5eba7f2b34d20b41e1ff90 = L.marker(
                [36.91846697002981, -118.20809887168937],
                {}
            ).addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
        var popup_f5fb856cee50414b6bd960245f218441 = L.popup({&quot;maxWidth&quot;: &quot;100%&quot;});

        
            
                var html_aa9bde408adcce333a81407af668c1e3 = $(`<div id=&quot;html_aa9bde408adcce333a81407af668c1e3&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Drew: 19.92 Acres</div>`)[0];
                popup_f5fb856cee50414b6bd960245f218441.setContent(html_aa9bde408adcce333a81407af668c1e3);
            
        

        marker_ba6940245e5eba7f2b34d20b41e1ff90.bindPopup(popup_f5fb856cee50414b6bd960245f218441)
        ;

        
    
    
            var marker_ab4eaa9c553f9d6aff08bbb6e4c05e7d = L.marker(
                [36.89979855072214, -118.19586436691745],
                {}
            ).addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
        var popup_0f86d28baa400470436dc4e615b51eac = L.popup({&quot;maxWidth&quot;: &quot;100%&quot;});

        
            
                var html_bdb7d60e2ed009b02e55c2b7e6e479c4 = $(`<div id=&quot;html_bdb7d60e2ed009b02e55c2b7e6e479c4&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Waggonner: 30.00 Acres</div>`)[0];
                popup_0f86d28baa400470436dc4e615b51eac.setContent(html_bdb7d60e2ed009b02e55c2b7e6e479c4);
            
        

        marker_ab4eaa9c553f9d6aff08bbb6e4c05e7d.bindPopup(popup_0f86d28baa400470436dc4e615b51eac)
        ;

        
    
    
            var marker_696823d8e9ebc3e7643967d03df8066f = L.marker(
                [36.89781800267362, -118.21569918171215],
                {}
            ).addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
        var popup_6229292ded127022c0f78451aa3bf8e6 = L.popup({&quot;maxWidth&quot;: &quot;100%&quot;});

        
            
                var html_2d55c2d09fc8b389f8f0eaca16e1aba6 = $(`<div id=&quot;html_2d55c2d09fc8b389f8f0eaca16e1aba6&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>West Winterton: 40.35 Acres</div>`)[0];
                popup_6229292ded127022c0f78451aa3bf8e6.setContent(html_2d55c2d09fc8b389f8f0eaca16e1aba6);
            
        

        marker_696823d8e9ebc3e7643967d03df8066f.bindPopup(popup_6229292ded127022c0f78451aa3bf8e6)
        ;

        
    
    
            var marker_5a2b5e662169c8e91b1fb717a5b9f772 = L.marker(
                [36.90110531089543, -118.20920202369373],
                {}
            ).addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
        var popup_94babad2a9c23c5238e06db93414a62c = L.popup({&quot;maxWidth&quot;: &quot;100%&quot;});

        
            
                var html_70d549ca73d2327819b51ad548bcb4a3 = $(`<div id=&quot;html_70d549ca73d2327819b51ad548bcb4a3&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>East Winterton: 0.22 Acres</div>`)[0];
                popup_94babad2a9c23c5238e06db93414a62c.setContent(html_70d549ca73d2327819b51ad548bcb4a3);
            
        

        marker_5a2b5e662169c8e91b1fb717a5b9f772.bindPopup(popup_94babad2a9c23c5238e06db93414a62c)
        ;

        
    
    
            var marker_2b410129869c9dff6ea161180d4ba0ee = L.marker(
                [36.878012701624925, -118.20090485228432],
                {}
            ).addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
        var popup_4f992b15a5fe57a72d95eea6eab9b09f = L.popup({&quot;maxWidth&quot;: &quot;100%&quot;});

        
            
                var html_02ff9f0803c7f94749c4ee29726abcb4 = $(`<div id=&quot;html_02ff9f0803c7f94749c4ee29726abcb4&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>South Winterton: 0.77 Acres</div>`)[0];
                popup_4f992b15a5fe57a72d95eea6eab9b09f.setContent(html_02ff9f0803c7f94749c4ee29726abcb4);
            
        

        marker_2b410129869c9dff6ea161180d4ba0ee.bindPopup(popup_4f992b15a5fe57a72d95eea6eab9b09f)
        ;

        
    
    
            var marker_e8babc668e1068210f4ab06bda30cc25 = L.marker(
                [36.87867846980565, -118.21664203614019],
                {}
            ).addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
        var popup_b5bc9350fb02b15244d9dc2664789319 = L.popup({&quot;maxWidth&quot;: &quot;100%&quot;});

        
            
                var html_2d608b2216f7d4325be7cd86c8046e2b = $(`<div id=&quot;html_2d608b2216f7d4325be7cd86c8046e2b&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Thibaut Ponds: 12.45 Acres</div>`)[0];
                popup_b5bc9350fb02b15244d9dc2664789319.setContent(html_2d608b2216f7d4325be7cd86c8046e2b);
            
        

        marker_e8babc668e1068210f4ab06bda30cc25.bindPopup(popup_b5bc9350fb02b15244d9dc2664789319)
        ;

        
    
    
            var layer_control_37fa84f125578758dde4770be39cdc8d_layers = {
                base_layers : {
                    &quot;openstreetmap&quot; : tile_layer_42711bafc96c20d9823890e78aeb40e6,
                },
                overlays :  {
                    &quot;Flooded Pixels&quot; : tile_layer_7fc230a1a7b190c1da0b1538fa14e294,
                    &quot;Unit Boundaries&quot; : tile_layer_3694564b2dbae984a7dfcf82feca929f,
                },
            };
            let layer_control_37fa84f125578758dde4770be39cdc8d = L.control.layers(
                layer_control_37fa84f125578758dde4770be39cdc8d_layers.base_layers,
                layer_control_37fa84f125578758dde4770be39cdc8d_layers.overlays,
                {&quot;autoZIndex&quot;: true, &quot;collapsed&quot;: true, &quot;position&quot;: &quot;topright&quot;}
            ).addTo(map_627d572cfc8aa660541755980b16d5b8);

        
    
            tile_layer_42711bafc96c20d9823890e78aeb40e6.addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
            tile_layer_7fc230a1a7b190c1da0b1538fa14e294.addTo(map_627d572cfc8aa660541755980b16d5b8);
        
    
            tile_layer_3694564b2dbae984a7dfcf82feca929f.addTo(map_627d572cfc8aa660541755980b16d5b8);
        
</script>
</html>" width="100%" height="600" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"=""></iframe>
</div>
</div>
<p>Write csv Table</p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the subdirectory for CSV output</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>csv_subdirectory <span class="op">=</span> <span class="st">"flood_reports/csv_output"</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>os.makedirs(csv_subdirectory, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the DataFrame to a CSV file</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>units_df_properties_reduced <span class="op">=</span> pd.DataFrame(units_with_calculations.getInfo()[<span class="st">'features'</span>])</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>units_df_properties_reduced <span class="op">=</span> pd.json_normalize(units_df_properties_reduced[<span class="st">'properties'</span>])</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>units_df_properties_reduced <span class="op">=</span> units_df_properties_reduced[[<span class="st">'Flood_Unit'</span>, <span class="st">'total_pixels'</span>, <span class="st">'flooded_pixels'</span>, <span class="st">'unit_acres'</span>, <span class="st">'acres_flooded'</span>]]</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the CSV filename with the new directory</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>csv_filename <span class="op">=</span> os.path.join(csv_subdirectory, <span class="ss">f'flood_report_data_</span><span class="sc">{</span>image_date_str<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>threshold<span class="sc">}</span><span class="ss">.csv'</span>)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co"># csv_filename = f'flood_report_data_{image_date_str}.csv'</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>units_df_properties_reduced.to_csv(csv_filename, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
</div>
<p>Create HTML Table</p>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns for display</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>units_df_properties_reduced <span class="op">=</span> units_df_properties_reduced[[<span class="st">'Flood_Unit'</span>, <span class="st">'acres_flooded'</span>]]</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>units_df_properties_reduced.columns <span class="op">=</span> [<span class="st">'BWMA Unit'</span>, <span class="st">'Acres'</span>]</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Round acres to whole numbers</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>units_df_properties_reduced[<span class="st">'Acres'</span>] <span class="op">=</span> units_df_properties_reduced[<span class="st">'Acres'</span>].<span class="bu">round</span>(<span class="dv">0</span>).astype(<span class="bu">int</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate totals</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>total_acres <span class="op">=</span> units_df_properties_reduced[<span class="st">'Acres'</span>].<span class="bu">sum</span>()</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>totals_row <span class="op">=</span> pd.DataFrame([{<span class="st">'BWMA Unit'</span>: <span class="st">'Total'</span>, <span class="st">'Acres'</span>: total_acres}])</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Append the totals row to the DataFrame</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>units_df_properties_reduced <span class="op">=</span> pd.concat([units_df_properties_reduced, totals_row], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Style the DataFrame and convert to HTML</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>html_table_simple <span class="op">=</span> (</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    units_df_properties_reduced.style</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    .set_table_styles([</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>        {<span class="st">'selector'</span>: <span class="st">'th'</span>, <span class="st">'props'</span>: [(<span class="st">'text-align'</span>, <span class="st">'center'</span>), (<span class="st">'font-size'</span>, <span class="st">'14px'</span>)]},</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>        {<span class="st">'selector'</span>: <span class="st">'td:nth-child(1)'</span>, <span class="st">'props'</span>: [(<span class="st">'text-align'</span>, <span class="st">'left'</span>), (<span class="st">'font-size'</span>, <span class="st">'12px'</span>)]},</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>        {<span class="st">'selector'</span>: <span class="st">'td:nth-child(2)'</span>, <span class="st">'props'</span>: [(<span class="st">'text-align'</span>, <span class="st">'right'</span>), (<span class="st">'font-size'</span>, <span class="st">'12px'</span>)]},</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>    .set_properties(subset<span class="op">=</span>pd.IndexSlice[units_df_properties_reduced.index[<span class="op">-</span><span class="dv">1</span>], :], <span class="op">**</span>{<span class="st">'font-weight'</span>: <span class="st">'bold'</span>, <span class="st">'font-size'</span>: <span class="st">'14px'</span>})</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>    .hide(axis<span class="op">=</span><span class="st">'index'</span>)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>    .to_html()</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually hide the index in the HTML string</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>html_table_simple <span class="op">=</span> html_table_simple.replace(<span class="st">'&lt;th&gt;&lt;/th&gt;'</span>, <span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
</div>
<p>Create HTML Report</p>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># HTML report</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>html_report <span class="op">=</span> <span class="ss">f"""</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;html&gt;</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;head&gt;</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;title&gt;BWMA Flooded Extent: </span><span class="sc">{</span>image_date_str<span class="sc">}</span><span class="ss">&lt;/title&gt;</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;style&gt;</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: Arial, sans-serif;</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="ss">        .container </span><span class="ch">{{</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex;</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between;</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="ss">        .left </span><span class="ch">{{</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="ss">            width: 25%;</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="ss">        .right </span><span class="ch">{{</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="ss">            width: 75%;</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center;</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="ss">        h1, h2 </span><span class="ch">{{</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center;</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a><span class="ss">        .notes </span><span class="ch">{{</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-top: 20px;</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 10px;</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-top: 1px solid #000;</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a><span class="ss">        /*----CHANGE---- Increase font size and add line above totals row */</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a><span class="ss">        table </span><span class="ch">{{</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a><span class="ss">            width: 90%;</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 50px;</span></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-collapse: collapse;</span></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a><span class="ss">        th, td </span><span class="ch">{{</span></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px;</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: left;</span></span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-bottom: 1px solid #ddd;</span></span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a><span class="ss">        th </span><span class="ch">{{</span></span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: right;//from center</span></span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 30px;</span></span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a><span class="ss">        td:nth-child(2) </span><span class="ch">{{</span></span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: right;</span></span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a><span class="ss">        tr:last-child </span><span class="ch">{{</span></span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold;</span></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 80px;</span></span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a><span class="ss">        tr:last-child td </span><span class="ch">{{</span></span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-top: 3px solid #000;</span></span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/style&gt;</span></span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/head&gt;</span></span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;body&gt;</span></span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;h1&gt;BWMA Flooded Acres and Extent: </span><span class="sc">{</span>image_date_str<span class="sc">}</span><span class="ss">&lt;/h1&gt;</span></span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;div class="container"&gt;</span></span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class="left"&gt;</span></span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;h2&gt;Flooded Acres&lt;/h2&gt;</span></span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="sc">{</span>html_table_simple<span class="sc">}</span></span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class="right"&gt;</span></span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;h2&gt;Spatial Extent&lt;/h2&gt;</span></span>
<span id="cb31-67"><a href="#cb31-67" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;p&gt;Imagery Date: </span><span class="sc">{</span>image_date_str<span class="sc">}</span><span class="ss">&lt;/p&gt;</span></span>
<span id="cb31-68"><a href="#cb31-68" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;iframe src="flooded_area_map_</span><span class="sc">{</span>image_date_str<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>threshold<span class="sc">}</span><span class="ss">.html" width="90%" height="500"&gt;&lt;/iframe&gt;</span></span>
<span id="cb31-69"><a href="#cb31-69" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb31-70"><a href="#cb31-70" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/div&gt;</span></span>
<span id="cb31-71"><a href="#cb31-71" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;div class="notes"&gt;</span></span>
<span id="cb31-72"><a href="#cb31-72" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;h3&gt;Technical Notes&lt;/h3&gt;</span></span>
<span id="cb31-73"><a href="#cb31-73" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;p&gt;Flooded acres were calculated from Sentinel-2 Surface Reflectance imagery using the Earth Engine Python API in a Jupyter notebook.  Sentinel-2 (S2) is a wide-swath, high-resolution, multispectral imaging mission with a global 5-day revisit frequency.&lt;/p&gt;</span></span>
<span id="cb31-74"><a href="#cb31-74" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;p&gt;The S2 Multispectral Instrument (MSI) samples 13 spectral bands: Visible and NIR at 10 meters, red edge and SWIR at 20 meters, and atmospheric bands at 60 meters spatial resolution. The Near Infrared (NIR) band was used to identify flooded areas by applying a threshold to isolate water.&lt;/p&gt;</span></span>
<span id="cb31-75"><a href="#cb31-75" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;p&gt;The results are validated during routine field checks throughout the seasonal flooding cycle September through April.&lt;/p&gt;</span></span>
<span id="cb31-76"><a href="#cb31-76" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/div&gt;</span></span>
<span id="cb31-77"><a href="#cb31-77" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/body&gt;</span></span>
<span id="cb31-78"><a href="#cb31-78" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/html&gt;</span></span>
<span id="cb31-79"><a href="#cb31-79" aria-hidden="true" tabindex="-1"></a><span class="ss">"""</span></span>
<span id="cb31-80"><a href="#cb31-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-81"><a href="#cb31-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the report to an HTML file in the subdirectory</span></span>
<span id="cb31-82"><a href="#cb31-82" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(report_filename, <span class="st">"w"</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb31-83"><a href="#cb31-83" aria-hidden="true" tabindex="-1"></a>    <span class="bu">file</span>.write(html_report)</span>
<span id="cb31-84"><a href="#cb31-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-85"><a href="#cb31-85" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Report saved to </span><span class="sc">{</span>report_filename<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb31-86"><a href="#cb31-86" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Map saved to </span><span class="sc">{</span>map_filename<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

            <style>
                .geemap-dark {
                    --jp-widgets-color: white;
                    --jp-widgets-label-color: white;
                    --jp-ui-font-color1: white;
                    --jp-layout-color2: #454545;
                    background-color: #383838;
                }

                .geemap-dark .jupyter-button {
                    --jp-layout-color3: #383838;
                }

                .geemap-colab {
                    background-color: var(--colab-primary-surface-color, white);
                }

                .geemap-colab .jupyter-button {
                    --jp-layout-color3: var(--colab-primary-surface-color, white);
                }
            </style>
            
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Report saved to flood_reports/html_reports_maps\bwma_flood_report_2024-09-22_0.21.html
Map saved to flood_reports/html_reports_maps\flooded_area_map_2024-09-22_0.21.html</code></pre>
</div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>